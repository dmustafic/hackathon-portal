"use strict";angular.module("hackApp",["ui.router","hackController","categoryFilter","errorDescriptionFilter","syncPrismDirective","apiListItemDirective","apiSpecificationCardDirective","apiExampleCardDirective","apiTryItCardDirective","apiListDirective","apiService","examplesService","specificationsService","tryItService","apiDocumentationController","gettingStartedController","sampleAppsController"]).constant("authString","Basic cHJvdmlkZXI6MTIzNA==").constant("apiKey","api-key-1234").constant("emulatorDomain","http://lightning.att.io:3000").constant("specificationUrl",hack.rootPath+"/dist/data/specifications.json").constant("emptyImagePath",hack.rootPath+"/dist/images/empty.gif").constant("dataPath",hack.rootPath+"/data").constant("androidExampleUrl",hack.rootPath).constant("iosExampleUrl",hack.rootPath).constant("webExampleUrl",hack.rootPath).constant("androidExampleCommonFilePath",hack.rootPath+"/data/examples/android/app/src/com/idean/atthack/network/RequestHelper.java").constant("iosExampleCommonFilePath",hack.rootPath+"/data/examples/ios/example.m").constant("webExampleCommonFilePath",hack.rootPath+"/dist/data/web-examples.js").constant("sideBarLinks",[{isStateRoute:!0,ref:"getting-started",label:"Getting Started",url:"/getting-started",templateUrl:hack.rootPath+"/dist/templates/routes/getting-started/getting-started.html",controller:"GettingStartedCtrl"},{isStateRoute:!0,ref:"api-documentation",label:"API Documentation",url:"/api-documentation",templateUrl:hack.rootPath+"/dist/templates/routes/api-documentation/api-documentation.html",controller:"ApiDocumentationCtrl"},{isStateRoute:!0,ref:"sample-apps",label:"Sample Apps",url:"/sample-apps",templateUrl:hack.rootPath+"/dist/templates/routes/sample-apps/sample-apps.html",controller:"SampleAppsCtrl"}]).constant("httpErrorCodes",{200:"OK",301:"Moved permanently",302:"Found",400:"Bad request (invalid parameters)",401:"Not authenticated",403:"Not authorized to use the service",404:"Resource not found",412:"Resource already exists",500:"Internal error",503:"Service unavailable"}).constant("apiList",{"2.6-vehicle-remote-services":["2.6.1-sign-up","2.6.2-validate-otp","2.6.3-set-pin","2.6.4-login","2.6.5-door-unlock","2.6.6-door-lock","2.6.7-engine-on","2.6.8-engine-off","2.6.9-honk-and-blink","2.6.10-check-request-status","2.6.11-view-diagnostic-data","2.6.12-get-vehicle-status"],"2.7-vehicle-telematics":["2.7.1-get-message","2.7.2-send-message","2.7.3-tcu-shoulder-tap","2.7.4-ping-tcu","2.7.5-tcu-notification-channel"],"2.12-commerce":["2.12.1-consume","2.12.2-consume-by-ticket-id","2.12.3-check-valid-ticket","2.12.4-create-premium-offers","2.12.5-deactivate-one-time-purchase","2.12.6-deactivate-recurrent-purchase","2.12.7-full-purchase","2.12.8-get-prices","2.12.9-get-products","2.12.10-get-products-by-ids","2.12.11-get-user-purchases","2.12.12-get-user-tickets","2.12.13-get-tickets-by-purchase-id","2.12.14-get-tickets-by-ticket-id","2.12.15-purchase","2.12.16-purchase-by-premium-offer-id","2.12.17-purchase-by-product-id","2.12.18-refund","2.12.19-resume-recurrent-purchase","2.12.20-stop-purchase-renewal","2.12.21-extend-one-time-purchase","2.12.22-extend-recurrent-purchase","2.12.23-full-gift","2.12.24-gift","2.12.25-gift-by-product-id","2.12.26-gift-by-premium-offer-id","2.12.27-refill"],"2.13-subscriber-management":["2.13.1-add-a-subscriber","2.13.2-add-a-subscriber-and-vehicle","2.13.3-update-a-subscriber","2.13.4-delete-a-subscriber","2.13.5-view-a-subscriber","2.13.6-search-subscribers"],"2.16-vehicle-management":["2.16.1-add-a-vehicle","2.16.2-update-a-vehicle","2.16.3-delete-a-vehicle","2.16.4-view-a-vehicle","2.16.5-update-vehicle-users","2.16.6-delete-vehicle-users","2.16.7-search-vehicles"]}).constant("categories",[{id:"know-driver",name:"Know the Driver"},{id:"know-car",name:"Know the Car"},{id:"control-car",name:"Control the Car"}]).run(["$rootScope","categories","HackApi",function(e,t,a){e.defaultCategory=t[1],a.fetchAllApiData()}]),angular.module("categoryFilter",[]).filter("category",function(){return function(e,t){var a,r,i,n;for(n=[],a=0,r=0,i=e.length;i>a;a+=1)e[a].specification.categories.indexOf(t)>=0&&(n[r++]=e[a]);return n}}),angular.module("errorDescriptionFilter",[]).filter("errorDescription",["httpErrorCodes",function(e){return function(t){return e[t]||"Unknown error"}}]),angular.module("hackController",[]).controller("HackCtrl",["$scope","$rootScope","$state","sideBarLinks","categories",function(e,t,a,r,i){e.hackState={},e.hackState.sideBarLinks=r,e.hackState.categories=i,e.hackState.handleCategoryTabClick=function(e){t.selectedCategory=e,"api-documentation"!==t.routeState.name&&a.go("api-documentation")}}]),angular.module("hackApp").config(["$locationProvider","$stateProvider","$urlRouterProvider","sideBarLinks",function(e,t,a,r){a.otherwise(r[1].url),r.forEach(function(e){e.isStateRoute&&t.state(e.ref,{url:e.url,templateUrl:e.templateUrl,controller:e.controller})})}]).run(["$rootScope","$log",function(e,t){e.routeState={},e.$on("$stateChangeStart",function(a,r){t.debug("$stateChangeStart",r.name),e.routeState=r,e.selectedCategory="api-documentation"!==r.name||e.selectedCategory?null:e.defaultCategory}),e.$on("$stateNotFound",function(e,a){t.debug("$stateNotFound",a.name)}),e.$on("$stateChangeSuccess",function(e,a){t.debug("$stateChangeSuccess",a.name)}),e.$on("$stateChangeError",function(e,a,r,i,n,o){t.debug("$stateChangeError",a.name,o)})}]),angular.module("syncPrismDirective",[]).directive("syncPrism",[function(){return{restrict:"A",scope:{source:"@"},link:function(e,t){var a=t.find("code")[0];e.$watch("source",function(){Prism.highlightElement(a)})},template:'<code ng-bind="source"></code>'}}]),angular.module("apiService",[]).factory("HackApi",["$q","$http","$log","$filter","HackSpecifications","HackExamples","categories","androidExampleCommonFilePath","iosExampleCommonFilePath","webExampleCommonFilePath",function(e,t,a,r,i,n,o){function s(){o.forEach(function(e){l.apiDataByCategory[e.id]=r("category")(l.apiData,e.id)})}function c(){function e(e,a,r){var i,n,o;return i=e.split(u),n=t(m,a,i,0)+1,o=t(d,a,i,n),n>=0&&o>=0?i.slice(n,o).join(u):(console.warn("Example not found in file: platform="+r+", specificationId="+a),"// Example forthcoming")}function t(e,t,a,r){var i,n;for(i=r,n=a.length;n>i;i+=1){if(e.exec(a[i])&&a[i].indexOf(t,e.lastIndex)===e.lastIndex)return e.lastIndex=0,i;e.lastIndex=0}return-1}var a,r,i,n,o,s,c,p,u="\n",m=/^\s*\/\/ ## START /g,d=/^\s*\/\/ ## END /g;for(o=["web","android","ios"],a=0,i=o.length;i>a;a+=1)for(s=o[a],r=0,n=l.apiData.length;n>r;r+=1)c=l.apiData[r].specification.id,p=l.apiData[r].example[s].file.text,l.apiData[r].example[s].text=e(p,c,s)}var l={fetchAllApiData:function(){return i.getAllSpecificationsData().then(n.getAllExamplesData).then(function(){var e,t;t=0;for(e in i.specificationsData)l.apiData[t++]={key:e,specification:i.specificationsData[e],example:n.examplesData[e]};c(),s()})},getAllApiData:function(){var t=e.defer();return l.apiData.length>0?t.resolve(l.apiData):l.fetchAllApiData().then(function(){t.resolve(l.apiData)}),t.promise},apiData:[],apiDataByCategory:{}};return l}]),angular.module("examplesService",[]).factory("HackExamples",["$q","$http","$log","HackSpecifications","dataPath","apiList","androidExampleUrl","iosExampleUrl","webExampleUrl",function(e,t,a,r,i,n,o,s,c){var l={fetchExampleData:function(a,i,n){var p,u;return"all"===n?(u=[],["web","ios","android"].forEach(function(e){u.push(l.fetchExampleData(a,i,e))}),e.all(u)):(p="android"===n?o:"ios"===n?s:c,p+=r.specificationsData[i].codeExamples[n],l.examplesData[i]=l.examplesData[i]?l.examplesData[i]:{},l.examplesData[i][n]={file:{url:p,text:""},text:""},l.fileCache[p]?(l.fileCache[p].then(function(e){l.examplesData[i][n].file.text=e}),l.fileCache[p]):void(l.fileCache[p]=t.get(p).then(function(e){return l.examplesData[i][n].file.text=e.data,e.data}).catch(function(){return l.examplesData[i][n].file.text="",""})))},fetchAllExamplesData:function(){var t,a=[];for(t in n)n[t].forEach(function(e){a.push(l.fetchExampleData(t,e,"all"))});return e.all(a).then(function(){l.allDataHasBeenFetched=!0})},getAllExamplesData:function(){var t=e.defer();return l.allDataHasBeenFetched?t.resolve(l.examplesData):l.fetchAllExamplesData().then(function(){t.resolve(l.examplesData)}),t.promise},allDataHasBeenFetched:!1,fileCache:{},examplesData:{}};return l}]),angular.module("specificationsService",[]).factory("HackSpecifications",["$q","$http","$log","dataPath","specificationUrl",function(e,t,a,r,i){var n={fetchAllSpecificationsData:function(){return t.get(i).then(function(e){var t,a;for(t=0,a=e.data.length;a>t;t+=1)n.specificationsData[e.data[t].id]=e.data[t];n.allDataHasBeenFetched=!0})},getAllSpecificationsData:function(){var t=e.defer();return n.allDataHasBeenFetched?t.resolve(n.specificationsData):n.fetchAllSpecificationsData().then(function(){t.resolve(n.specificationsData)}),t.promise},allDataHasBeenFetched:!1,specificationsData:{}};return n}]),angular.module("tryItService",[]).constant("routeParams",["vin"]).constant("queryParams",["longpoll"]).factory("TryItData",["emulatorDomain","routeParams","queryParams",function(e,t,a){function r(){return""+parseInt(1e10*Math.random())}function i(){return""+(Math.random()<.5)}function n(){for(c=0,l=t.length;l>c;c+=1)o.routeParams[t[c]]=s.routeParams[t[c]];for(c=0,l=a.length;l>c;c+=1)o.queryParams[a[c]]=s.queryParams[a[c]];o.emulatorDomain=s.emulatorDomain}var o,s,c,l;for(s={emulatorDomain:e,routeParams:{},queryParams:{}},o={emulatorDomain:s.emulatorDomain,routeParams:{},queryParams:{},reset:n},c=0,l=t.length;l>c;c+=1)s.routeParams[t[c]]=r();for(c=0,l=a.length;l>c;c+=1)s.queryParams[a[c]]=i();return n(),o}]),angular.module("apiExampleCardDirective",[]).constant("apiExampleCardTemplatePath",hack.rootPath+"/dist/templates/components/api-example-card/api-example-card.html").directive("apiExampleCard",["apiExampleCardTemplatePath",function(e){return{restrict:"E",require:"^apiListItem",scope:{apiItem:"="},templateUrl:e,link:function(){}}}]),angular.module("apiListDirective",[]).constant("apiListTemplatePath",hack.rootPath+"/dist/templates/components/api-list/api-list.html").directive("apiList",["HackApi","apiListTemplatePath",function(e,t){return{restrict:"E",scope:{category:"="},templateUrl:t,link:function(t){t.apiData=[],e.getAllApiData().then(function(e){t.apiData=e})},controller:["$scope",function(e){function t(e){var t=a;a=e,t&&t!==a&&t.setIsSelected(!1),a&&a.setIsSelected(!0)}var a;a=null,this.setSelectedSpecification=t,e.$watch("category",function(){t(null)})}]}}]),angular.module("apiListItemDirective",[]).constant("apiListItemTemplatePath",hack.rootPath+"/dist/templates/components/api-list-item/api-list-item.html").directive("apiListItem",["apiListItemTemplatePath",function(e){return{restrict:"A",require:"^apiList",scope:{apiItem:"=apiListItem"},templateUrl:e,link:function(e,t,a,r){e.isSelected=!1,e.apiItem.selectedCard="specification",e.apiItem.selectedPlatform="web",e.handleHeaderClick=function(){r.setSelectedSpecification(e.isSelected?null:e)},e.setIsSelected=function(t){e.isSelected=t}},controller:function(){}}}]),angular.module("apiSpecificationCardDirective",[]).constant("apiSpecificationCardTemplatePath",hack.rootPath+"/dist/templates/components/api-specification-card/api-specification-card.html").directive("apiSpecificationCard",["apiSpecificationCardTemplatePath",function(e){return{restrict:"E",require:"^apiListItem",scope:{apiItem:"="},templateUrl:e,link:function(e){e.isArray=function(e){return e instanceof Array}}}}]),angular.module("apiTryItCardDirective",[]).constant("apiTryItCardTemplatePath",hack.rootPath+"/dist/templates/components/api-try-it-card/api-try-it-card.html").directive("apiTryItCard",["TryItData","jsonFilter","errorDescriptionFilter","apiTryItCardTemplatePath","apiKey","authString",function(e,t,a,r,i,n){return{restrict:"E",require:"^apiListItem",scope:{apiItem:"="},templateUrl:r,link:function(r){function o(){var t,a,i,n,o,s;if(t=r.apiItem.specification.resourceTable.Route,s=t.indexOf("?"),s>=0){for(t=t.substring(0,s+1),a=0,i=r.apiItem.specification.parameters.query.length;i>a;a+=1)n=r.apiItem.specification.parameters.query[a],o=r.apiItem.tryIt.parameters.query[n],t+=n+"="+(o||"true")+"&",e.queryParams[n]=o;t=t.substring(0,t.length-1)}for(n in r.apiItem.specification.parameters.route)o=r.apiItem.tryIt.parameters.route[n],t=t.replace("{"+n+"}",o||""),e.routeParams[n]=o;r.apiItem.tryIt.url=e.emulatorDomain+t}function s(){"try it"===r.apiItem.selectedCard&&c()}function c(){function a(){var e="";return r.apiItem.specification.examples.forEach(function(a){"request"===a.type&&a.body&&(e=t(a.body))}),e}var i;for(i in r.apiItem.specification.parameters.route)r.apiItem.tryIt.parameters.route[i]=e.routeParams[i];for(i in r.apiItem.specification.parameters.query)r.apiItem.tryIt.parameters.query[i]=e.queryParams[i];r.apiItem.tryIt.parameters.requestBody=a()}r.apiItem.tryIt={},r.apiItem.tryIt.parameters={},r.apiItem.tryIt.parameters.route={},r.apiItem.tryIt.parameters.query={},r.apiItem.tryIt.parameters.requestBody="",r.apiItem.tryIt.response={},r.apiItem.TryItData=e,r.apiItem.tryIt.requestState="waiting-to-send",r.$watch("apiItem.tryIt.parameters.route",o,!0),r.$watch("apiItem.tryIt.parameters.query",o,!0),r.$watch("apiItem.TryItData.emulatorDomain",o,!0),r.$watch("apiItem.selectedCard",s),r.reset=function(){e.reset(),c()},r.handleSendRequestClick=function(){function e(){console.log("Response status="+s.status+" ("+s.statusText+")"),console.log("Response body="+s.response),r.$apply(function(){var e,t;e=a(s.status),r.apiItem.tryIt.requestState="received-response",r.apiItem.tryIt.response.error=2!==parseInt(s.status/100)&&e,r.apiItem.tryIt.response.status=s.status+" ("+e+")";try{t=JSON.parse(s.response)}catch(i){t="Unable to parse response body as JSON: "+s.response,console.warn(t)}r.apiItem.tryIt.response.body=t})}function t(){var e="An error occurred while transferring the data";console.error(e),r.$apply(function(){r.apiItem.tryIt.requestState="error-with-request",r.apiItem.tryIt.response.error=e})}function o(){var e="The transfer has been cancelled by the user";console.error(e),r.$apply(function(){r.apiItem.tryIt.requestState="error-with-request",r.apiItem.tryIt.response.error=e})}var s,c;c=r.apiItem.specification.resourceTable["HTTP Verb"][0],s=new XMLHttpRequest,s.addEventListener("load",e,!1),s.addEventListener("error",t,!1),s.addEventListener("abort",o,!1),console.log("Sending request to "+r.apiItem.tryIt.url),s.open(c,r.apiItem.tryIt.url,!0),s.setRequestHeader("Authorization",n),s.setRequestHeader("APIKey",i),s.setRequestHeader("Content-Type","application/json"),s.send(r.apiItem.tryIt.parameters.requestBody),r.apiItem.tryIt.requestState="waiting-for-response",r.apiItem.tryIt.response.error=!1,r.apiItem.tryIt.response.status=0,r.apiItem.tryIt.response.body={}}}}}]),angular.module("apiDocumentationController",[]).controller("ApiDocumentationCtrl",function(){}),angular.module("gettingStartedController",[]).controller("GettingStartedCtrl",function(){}),angular.module("sampleAppsController",[]).controller("SampleAppsCtrl",function(){});